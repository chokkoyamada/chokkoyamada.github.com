---
layout: post
title: "aws-summit-2013"
date: 2013-06-06 13:25
comments: true
categories: 
---

## Redshiftの概要

エンタープライズシステムにおける活用ノウハウ

Amazon Redshiftの取り組み
ASTERIA　WARP


クラウド型データウェアハウス
オンプレ環境におけるデータウェアハウスの課題
・初期投資
・運用管理
・成長予測・費用対効果

install backupなど
codingとperformance tuningに割く時間を増やせる

RDS, DynamoDBなどのオンライントランザクション→EMR, S3→Redshift


カラムナ型データベース
列が多いケースにはパフォーマンスの向上が見られやすい


* Leader Node クエリのパース・分析をしてC++コードを生成してcompute nodeに投げる

* compute nodes ここを増やすことで器を大きくできる

	1.6PBまで拡張可能

JDBCのPostgreSQLドライバを使える

AmazonS3かDynamoDBからの並列ロード

S3への自動バックアップ・増分バックアップ・オンデマンドのバックアップ　
リサイズする場合：新しいクラスタをバックグラウンドでプロビジョニング

ノード数×時間単価の課金　


日本ではデータウェアハウスとOLTPの中間的な使い方をしている場合が多い　

## Redshiftの性能は？

他と比較するとSEの寿命が縮まるので・・・

### 巨大テーブルからの検索処理

1.5TBくらいのデータの検索結果  500億件
8XL 2node 43.5sec
8xl 4node 27.8sec
8xl 8node 19.8sec

線形に性能が向上しているのに驚いた

### データロードのスピード 500億件

8XL 2node 2:54sec
8XL 4node 1:37
8xl 8node 0:46

### 1.2億件の検索結果

8XL 2node 3.30 sec
8XL 4node 1.40 sec
8XL 8node 1.80 sec

## バッチ処理は？

EMRとの比較
1.5TB, 500億件

EMR 29min
Redshift 17min

EMR 71min
Redshift 5min

チューニングのポイント
キー(index)

distribution keyに応じてスライスに配置される
sort keyをもとにレコードがソートされる

### チューニング効果
* 1.2億件

指定無しは1.8秒
指定ありは1秒

* バッチ処理

指定あり：24min
指定無し：16min

sort keyを入れるとロードは遅くなるので注意

### コスト:w
128coe 960gb 128tb storage
構築費はほぼ不要、維持管理のSEも不要、センター費用は不要

### 注意点は？
不得意なデータ形式もある
EMRで前処理

簡単につくれてしまうため、統制のきいていないシステムの乱立に注意

### まとめ

* 性能は線形にスケール
* バッチ処理も得意
* チューニングは新しい概念で
* 利用料課金はメリット大
* 注意点もある

## 事例

ASTERIA WARP
Pentaho
Jaspersoft

### Redshiftセミナー　
6/21
8/2


